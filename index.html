<script type="module">
    import { auth } from './firebase-config.js';
    import { onAuthStateChanged, signInWithEmailAndPassword, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-auth.js";
    
    const loader = document.getElementById('loader');
    const loginContainer = document.getElementById('login-container');

    onAuthStateChanged(auth, user => {
        if (user) {
            window.location.href = 'mi_tablero.html';
        } else {
            loader.style.display = 'none';
            loginContainer.style.display = 'flex';
        }
    });

    // El resto del script de login (manejo de formulario, google, etc.)
    const loginForm = document.getElementById('login-form'), googleLoginBtn = document.getElementById('google-login-btn'), loginErrorMessage = document.getElementById('login-error-message');
    loginForm.addEventListener('submit', async (e) => { e.preventDefault(); loginErrorMessage.textContent = ''; try { await signInWithEmailAndPassword(auth, loginForm['login-email'].value, loginForm['login-password'].value); } catch (error) { loginErrorMessage.textContent = 'Email o contraseña incorrectos.'; } });
    googleLoginBtn.addEventListener('click', async () => { loginErrorMessage.textContent = ''; try { await signInWithPopup(auth, new GoogleAuthProvider()); } catch (error) { loginErrorMessage.textContent = 'No se pudo iniciar sesión con Google.'; } });
    function setupPasswordToggle(inputId, toggleId, eyeOpenId, eyeClosedId) { const passwordInput = document.getElementById(inputId), toggle = document.getElementById(toggleId), eyeOpen = document.getElementById(eyeOpenId), eyeClosed = document.getElementById(eyeClosedId); if (!passwordInput || !toggle || !eyeOpen || !eyeClosed) return; toggle.addEventListener('click', () => { if (passwordInput.type === 'password') { passwordInput.type = 'text'; eyeOpen.classList.add('hidden'); eyeClosed.classList.remove('hidden'); } else { passwordInput.type = 'password'; eyeOpen.classList.remove('hidden'); eyeClosed.classList.add('hidden'); } }); }
    setupPasswordToggle('login-password', 'login-toggle', 'login-eye-open', 'login-eye-closed');
</script>
